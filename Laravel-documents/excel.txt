-laravel 10x install maatwebsite/excel
-go to enable gd extension (xampp -> apache -> config -> PHP ini)
-composer require maatwebsite/excel
-go to config/app.php
If you want to register it yourself, add the ServiceProvider
on providers
Maatwebsite\Excel\ExcelServiceProvider class
on aliases
Excel  Maatwebsite\Excel\Facades\Excel class







store data in db


public function data_store(Request $request)
{
    $request->validate([
        'file' => 'required|mimes:xls,xlsx'
    ]);
    // dd($request->selected_company_id);

    // Get the uploaded file
    $file = $request->file('file');
    
    // Process the Excel file
    $data = Excel::toArray([], $file);

    // Validate that data is an array
    if (!is_array($data) || empty($data)) {
        // Handle the case where Excel data is not valid
        return redirect()->back()->with('error', 'Invalid Excel data.');
    }

    // Extract column titles (keys)
    $keys = $data[0][0];

    // Find indexes of important columns
    $contIndex = array_search("contact_no", $keys);
    $lanIndex = array_search("language", $keys);

    // Initialize data set array
    $data_set = [];

    // Process each row of Excel data
    $skipFirstIteration = true;
    foreach ($data[0] as $row_values) {
        if ($skipFirstIteration) {
            $skipFirstIteration = false; // Set the flag to false after the first iteration
            continue; // Skip the first iteration
        }
        // Skip the row if it doesn't contain contact_no
        if (!isset($row_values[$contIndex])) {
            continue;
        }

        // Build data set
        $data_set = [];
        
        foreach ($keys as $index => $key) {
            
            
            $data_set[$key] = $row_values[$index];
        }

        // Encode data set to JSON
        $json_data_set = json_encode($data_set);

        // Create new record in the database
        $newRecord = ad_campaign::create([
            'campaign_id' => $request->selected_company_id,
            'contact_1' => $row_values[$contIndex],
            'contact_2' => '119',
        
            'language' => isset($row_values[$lanIndex]) ? $row_values[$lanIndex] : '',
            'data' => $json_data_set,
        ]);
    }

    // Redirect to the appropriate page
    return redirect(route('companies'));
}

    
}
